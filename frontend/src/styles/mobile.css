/* ═══════════════════════════════════════════════════════════════════════════════
   M-CRIT1: Mobile-first responsive overrides (320–430px primary, ≤768px general)
   ═══════════════════════════════════════════════════════════════════════════════ */

/* ── Global mobile fixes ─────────────────────────────────────────────────────── */
html, body, #root {
  overflow-x: hidden !important;
  max-width: 100vw !important;
}

/* ── Medium screens (tablets ≤ 768px) ────────────────────────────────────────── */
@media (max-width: 768px) {
  /* Hide sidebar on tablet and below */
  [data-mobile-sidebar] {
    display: none !important;
  }

  /* Show mobile sidebar toggle */
  [data-mobile-sidebar-toggle] {
    display: flex !important;
  }

  /* Stack RiskScore columns */
  [data-risk-layout] {
    flex-direction: column !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
  }
  [data-risk-layout] > div {
    width: 100% !important;
    border-right: none !important;
    border-bottom: 1px solid #1E2530;
    flex-shrink: 0 !important;
    min-height: auto !important;
  }

  /* Stack Portfolio columns */
  [data-portfolio-layout] {
    flex-direction: column !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
  }
  [data-portfolio-layout] > div {
    width: 100% !important;
    border-right: none !important;
    border-bottom: 1px solid #1E2530;
    flex-shrink: 0 !important;
    min-height: auto !important;
    overflow: visible !important;
  }

  /* Stack Fraud table + drawer */
  [data-fraud-layout] {
    flex-direction: column !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
  }
  [data-fraud-layout] > div {
    width: 100% !important;
    border-left: none !important;
    flex-shrink: 0 !important;
    min-height: auto !important;
    overflow: visible !important;
  }
  /* Fraud drawer full width on mobile */
  [data-fraud-drawer] {
    width: 100% !important;
    max-width: 100% !important;
  }

  /* TopBar: hide tickers and compress */
  [data-topbar-tickers] {
    display: none !important;
  }
  [data-topbar-clock] {
    display: none !important;
  }
  [data-topbar-sep] {
    display: none !important;
  }
  [data-topbar] {
    padding: 0 8px !important;
    gap: 0 !important;
    height: 44px !important;
    flex-wrap: nowrap !important;
  }
  [data-topbar] nav {
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch;
    gap: 0 !important;
  }
  [data-topbar] nav button {
    padding: 0 10px !important;
    font-size: 9px !important;
    white-space: nowrap;
    min-height: 44px;
  }
  [data-topbar-brand] {
    margin-right: 8px !important;
  }
  [data-topbar-brand] > span:first-child {
    font-size: 14px !important;
  }
  [data-topbar-brand] > div {
    display: none !important;
  }
  [data-topbar-right] {
    gap: 8px !important;
  }
  [data-topbar-right] > div:last-child > div:last-child {
    display: none !important; /* hide user name on tablet */
  }
}

/* ── Phone screens (≤ 430px) ─────────────────────────────────────────────────── */
@media (max-width: 430px) {
  /* TopBar ultra-compact */
  [data-topbar] {
    height: 40px !important;
    padding: 0 6px !important;
  }
  [data-topbar-brand] > span:first-child {
    font-size: 13px !important;
  }
  [data-topbar] nav button {
    padding: 0 8px !important;
    font-size: 8px !important;
    letter-spacing: 0.05em !important;
  }
  /* Hide user profile entirely on phone */
  [data-topbar-right] > div:last-child {
    display: none !important;
  }

  /* RiskScore: make gauge smaller and panels full-width */
  [data-risk-layout] {
    padding: 0 !important;
  }
  [data-risk-layout] > div {
    padding: 12px !important;
  }

  /* Portfolio: compact inputs */
  [data-portfolio-layout] > div {
    padding: 12px !important;
  }

  /* Fraud table: scroll horizontal if needed */
  [data-fraud-layout] table {
    font-size: 10px !important;
    min-width: 600px;
  }
  [data-fraud-table-wrap] {
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch;
  }

  /* Make all buttons touch-friendly (min 44px) */
  button {
    min-height: 40px;
    min-width: 40px;
  }
  /* But not tiny icon buttons */
  button[data-icon-btn] {
    min-height: 28px;
    min-width: 28px;
  }

  /* Ensure inputs are at least 16px font to prevent iOS zoom */
  input, select, textarea {
    font-size: 16px !important;
  }
}

/* ── Ultra-narrow (320px) ─────────────────────────────────────────────────────── */
@media (max-width: 360px) {
  [data-topbar] nav button {
    padding: 0 6px !important;
    font-size: 7px !important;
  }
  [data-topbar-brand] {
    display: none !important;
  }
}

/* ── Mobile sidebar overlay ──────────────────────────────────────────────────── */
[data-mobile-sidebar-overlay] {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.6);
  z-index: 200;
  display: none;
}
[data-mobile-sidebar-overlay].open {
  display: block;
}
[data-mobile-sidebar-panel] {
  position: fixed;
  left: 0;
  top: 0;
  bottom: 0;
  width: 260px;
  max-width: 80vw;
  z-index: 201;
  transform: translateX(-100%);
  transition: transform 0.25s ease;
  overflow-y: auto;
}
[data-mobile-sidebar-panel].open {
  transform: translateX(0);
}

/* ── Touch-friendly scrolling ────────────────────────────────────────────────── */
@media (max-width: 768px) {
  * {
    -webkit-tap-highlight-color: transparent;
  }
  [data-scrollable] {
    -webkit-overflow-scrolling: touch;
    overflow-y: auto;
  }
}
